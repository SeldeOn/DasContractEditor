{"version":3,"sources":["../../../../src/features/decision-table-head/editor/OutputEditingProvider.js"],"names":["closest","domClosest","matches","domMatches","OutputCell","OutputCellContextMenu","OutputEditingProvider","components","contextMenu","eventBus","renderer","onGetComponent","cellType","context","contextMenuType","on","event","output","target","node","getBoundingClientRect","left","top","offset","getOffset","open","x","y","align","$inject","element"],"mappings":";;;;;;AAAA,SACEA,OAAO,IAAIC,UADb,EAEEC,OAAO,IAAIC,UAFb,QAGO,SAHP;AAKA,OAAOC,UAAP,MAAuB,yBAAvB;AACA,OAAOC,qBAAP,MAAkC,oCAAlC;;IAGqBC,qB,6BAEnB,+BAAYC,UAAZ,EAAwBC,WAAxB,EAAqCC,QAArC,EAA+CC,QAA/C,EAAyD;AAAA;;AAEvDH,EAAAA,UAAU,CAACI,cAAX,CAA0B,MAA1B,EAAkC,gBAAkB;AAAA,QAAfC,QAAe,QAAfA,QAAe;;AAClD,QAAIA,QAAQ,KAAK,eAAjB,EAAkC;AAChC,aAAOR,UAAP;AACD;AACF,GAJD;AAMAG,EAAAA,UAAU,CAACI,cAAX,CAA0B,cAA1B,EAA0C,YAAkB;AAAA,QAAjBE,OAAiB,uEAAP,EAAO;;AAC1D,QACEA,OAAO,CAACC,eAAR,KAA4B,aAD9B,EAEE;AACA,aAAOT,qBAAP;AACD;AACF,GAND;AAQAI,EAAAA,QAAQ,CAACM,EAAT,CAAY,aAAZ,EAA2B,iBAAuB;AAAA,QAApBC,KAAoB,SAApBA,KAAoB;AAAA,QAAbC,MAAa,SAAbA,MAAa;AAChD,QAAQC,MAAR,GAAmBF,KAAnB,CAAQE,MAAR;AAEA,QAAMC,IAAI,GAAGlB,UAAU,CAACiB,MAAD,EAAS,IAAT,EAAe,IAAf,CAAvB;;AAEA,gCAAsBC,IAAI,CAACC,qBAAL,EAAtB;AAAA,QAAQC,IAAR,yBAAQA,IAAR;AAAA,QAAcC,GAAd,yBAAcA,GAAd;;AAEA,QAAMC,MAAM,GAAGC,SAAS,CAACL,IAAD,CAAxB;AAEAX,IAAAA,WAAW,CAACiB,IAAZ,CAAiB;AACfC,MAAAA,CAAC,EAAEL,IADY;AAEfM,MAAAA,CAAC,EAAEL,GAFY;AAGfM,MAAAA,KAAK,EAAE;AAHQ,KAAjB,EAIG;AACDd,MAAAA,eAAe,EAAE,aADhB;AAEDG,MAAAA,MAAM,EAANA,MAFC;AAGDM,MAAAA,MAAM,EAANA;AAHC,KAJH;AASD,GAlBD;AAmBD,C;;SArCkBjB,qB;AAyCrBA,qBAAqB,CAACuB,OAAtB,GAAgC,CAC9B,YAD8B,EAE9B,aAF8B,EAG9B,UAH8B,EAI9B,UAJ8B,CAAhC;;AAOA,SAASL,SAAT,CAAmBM,OAAnB,EAA4B;AAC1B,MAAI,CAAC3B,UAAU,CAAC2B,OAAD,EAAU,6BAAV,CAAf,EAAyD;AACvD,WAAO;AAAEJ,MAAAA,CAAC,EAAE,CAAC,CAAN;AAASC,MAAAA,CAAC,EAAE;AAAZ,KAAP;AACD;AACF","sourcesContent":["import {\n  closest as domClosest,\n  matches as domMatches\n} from 'min-dom';\n\nimport OutputCell from './components/OutputCell';\nimport OutputCellContextMenu from './components/OutputCellContextMenu';\n\n\nexport default class OutputEditingProvider {\n\n  constructor(components, contextMenu, eventBus, renderer) {\n\n    components.onGetComponent('cell', ({ cellType }) => {\n      if (cellType === 'output-header') {\n        return OutputCell;\n      }\n    });\n\n    components.onGetComponent('context-menu', (context = {}) => {\n      if (\n        context.contextMenuType === 'output-edit'\n      ) {\n        return OutputCellContextMenu;\n      }\n    });\n\n    eventBus.on('output.edit', ({ event, output }) => {\n      const { target } = event;\n\n      const node = domClosest(target, 'th', true);\n\n      const { left, top } = node.getBoundingClientRect();\n\n      const offset = getOffset(node);\n\n      contextMenu.open({\n        x: left,\n        y: top,\n        align: 'bottom-right'\n      }, {\n        contextMenuType: 'output-edit',\n        output,\n        offset\n      });\n    });\n  }\n\n}\n\nOutputEditingProvider.$inject = [\n  'components',\n  'contextMenu',\n  'eventBus',\n  'renderer'\n];\n\nfunction getOffset(element) {\n  if (!domMatches(element, '.output-cell + .output-cell')) {\n    return { x: -1, y: 0 };\n  }\n}"],"file":"OutputEditingProvider.js"}