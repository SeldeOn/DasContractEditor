{"version":3,"sources":["../../../../../src/features/decision-table-head/editor/components/InputCellContextMenu.js"],"names":["Component","InputEditor","inject","InputCellContextMenu","props","context","input","unsaved","state","label","inputExpressionProperties","changes","hasKeys","inputExpression","modeling","updateProperties","setState","persistChanges","debounceInput","attr","target","get","getValue","handleChange","$inject","obj","Object","keys","length"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAASA,SAAT,QAA0B,SAA1B;AAEA,OAAOC,WAAP,MAAwB,eAAxB;AAEA,SACEC,MADF,QAEO,yBAFP;;IAKqBC,oB;;;;;AAEnB,gCAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AAAA;;AAAA;;AAC1B,8BAAMD,KAAN,EAAaC,OAAb;;AAD0B,qEAUX,YAAM;AACrB,UAAQC,KAAR,GAAkB,MAAKF,KAAL,CAAWC,OAA7B,CAAQC,KAAR;AAEA,UAAQC,OAAR,GAAoB,MAAKC,KAAzB,CAAQD,OAAR;;AAEA,UAAI,CAACA,OAAL,EAAc;AACZ;AACD;;AAED,UACEE,KADF,GAGIF,OAHJ,CACEE,KADF;AAAA,UAEKC,yBAFL,4BAGIH,OAHJ;;AAKA,UAAII,OAAO,GAAG,EAAd;;AAEA,UAAI,WAAWJ,OAAf,EAAwB;AACtBI,QAAAA,OAAO,CAACF,KAAR,GAAgBA,KAAhB;AACD;;AAED,UAAIG,OAAO,CAACF,yBAAD,CAAX,EAAwC;AACtCC,QAAAA,OAAO,CAACE,eAAR,GAA0BH,yBAA1B;AACD;;AAED,YAAKI,QAAL,CAAcC,gBAAd,CAA+BT,KAA/B,EAAsCK,OAAtC;;AAEA,YAAKK,QAAL,CAAc;AACZT,QAAAA,OAAO,EAAE;AADG,OAAd;AAGD,KAvC2B;;AAAA,mEAyCb,UAACI,OAAD,EAAa;AAC1B,YAAKK,QAAL,CAAc;AACZT,QAAAA,OAAO,kCACF,MAAKC,KAAL,CAAWD,OADT,GAEFI,OAFE;AADK,OAAd,EAKG,MAAKM,cALR;AAMD,KAhD2B;;AAG1B,UAAKT,KAAL,GAAa,EAAb;AAEAN,IAAAA,MAAM,+BAAN;AAEA,UAAKe,cAAL,GAAsB,MAAKC,aAAL,CAAmB,MAAKD,cAAxB,CAAtB;AAP0B;AAQ3B;;;;WA0CD,kBAASE,IAAT,EAAe;AACb,UAAMb,KAAN,GAAgB,KAAKF,KAAL,CAAWC,OAA3B,CAAMC,KAAN;AAEA,UAAQC,OAAR,GAAoB,KAAKC,KAAzB,CAAQD,OAAR;AAEA,UAAIa,MAAM,GAAGd,KAAb,CALa,CAOb;;AACA,UAAIa,IAAI,KAAK,MAAb,EAAqB;AACnBC,QAAAA,MAAM,GAAGA,MAAM,CAACP,eAAhB;AACD;;AAED,aAAON,OAAO,IAAIY,IAAI,IAAIZ,OAAnB,GAA6BA,OAAO,CAACY,IAAD,CAApC,GAA6CC,MAAM,CAACC,GAAP,CAAWF,IAAX,CAApD;AACD;;;WAED,kBAAS;AACP;AAAA,iBAEY,KAAKG,QAAL,CAAc,OAAd,CAFZ;AAAA,gBAGW,KAAKA,QAAL,CAAc,MAAd,CAHX;AAAA,oBAIe,KAAKC;AAJpB;AAMD;;;;EA1E+CvB,S;;SAA7BG,oB;AA6ErBA,oBAAoB,CAACqB,OAArB,GAA+B,CAC7B,eAD6B,EAE7B,UAF6B,EAG7B,UAH6B,CAA/B,C,CAOA;;AAEA,SAASZ,OAAT,CAAiBa,GAAjB,EAAsB;AACpB,SAAOC,MAAM,CAACC,IAAP,CAAYF,GAAZ,EAAiBG,MAAxB;AACD","sourcesContent":["import { Component } from 'inferno';\n\nimport InputEditor from './InputEditor';\n\nimport {\n  inject\n} from 'table-js/lib/components';\n\n\nexport default class InputCellContextMenu extends Component {\n\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = {};\n\n    inject(this);\n\n    this.persistChanges = this.debounceInput(this.persistChanges);\n  }\n\n  persistChanges = () => {\n    const { input } = this.props.context;\n\n    const { unsaved } = this.state;\n\n    if (!unsaved) {\n      return;\n    }\n\n    const {\n      label,\n      ...inputExpressionProperties\n    } = unsaved;\n\n    var changes = { };\n\n    if ('label' in unsaved) {\n      changes.label = label;\n    }\n\n    if (hasKeys(inputExpressionProperties)) {\n      changes.inputExpression = inputExpressionProperties;\n    }\n\n    this.modeling.updateProperties(input, changes);\n\n    this.setState({\n      unsaved: false\n    });\n  }\n\n  handleChange = (changes) => {\n    this.setState({\n      unsaved: {\n        ...this.state.unsaved,\n        ...changes\n      }\n    }, this.persistChanges);\n  };\n\n  getValue(attr) {\n    let { input } = this.props.context;\n\n    const { unsaved } = this.state;\n\n    let target = input;\n\n    // input variable stored in parent\n    if (attr === 'text') {\n      target = target.inputExpression;\n    }\n\n    return unsaved && attr in unsaved ? unsaved[attr] : target.get(attr);\n  }\n\n  render() {\n    return (\n      <InputEditor\n        label={ this.getValue('label') }\n        text={ this.getValue('text') }\n        onChange={ this.handleChange } />\n    );\n  }\n}\n\nInputCellContextMenu.$inject = [\n  'debounceInput',\n  'modeling',\n  'injector'\n];\n\n\n// helpers //////////////////////\n\nfunction hasKeys(obj) {\n  return Object.keys(obj).length;\n}"],"file":"InputCellContextMenu.js"}