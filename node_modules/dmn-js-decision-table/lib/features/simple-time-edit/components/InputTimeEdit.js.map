{"version":3,"sources":["../../../../src/features/simple-time-edit/components/InputTimeEdit.js"],"names":["Component","ValidatedInput","InputSelect","getTimeString","getSampleTime","validateISOString","parseString","EXACT","BEFORE","AFTER","BETWEEN","InputTimeEdit","props","context","_modeling","injector","get","element","parsedString","businessObject","text","times","time","state","type","debounceInput","debouncedEditCell","editCell","bind","onTypeChange","onSetStartTimeNowClick","onSetEndTimeNowClick","onStartTimeInput","onEndTimeInput","cell","value","setState","options","label"],"mappings":"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","sourcesContent":["import { Component } from 'inferno';\n\nimport ValidatedInput from 'dmn-js-shared/lib/components/ValidatedInput';\n\nimport InputSelect from 'dmn-js-shared/lib/components/InputSelect';\n\nimport {\n  getTimeString,\n  getSampleTime,\n  validateISOString,\n  parseString\n} from '../Utils';\n\nconst EXACT = 'exact',\n      BEFORE = 'before',\n      AFTER = 'after',\n      BETWEEN = 'between';\n\n\nexport default class InputTimeEdit extends Component {\n\n  constructor(props, context) {\n    super(props, context);\n\n    this._modeling = context.injector.get('modeling');\n\n    const { element } = this.props.context;\n\n    const parsedString = parseString(element.businessObject.text);\n\n    if (parsedString) {\n      let times;\n\n      if (parsedString.time) {\n        times = [ parsedString.time, '' ];\n      } else if (parsedString.times) {\n        times = parsedString.times;\n      } else {\n        times = [ '', '' ];\n      }\n\n      this.state = {\n        type: parsedString.type,\n        times: times\n      };\n    } else {\n      this.state = {\n        type: EXACT,\n        times: [ '', '' ]\n      };\n    }\n\n    const debounceInput = context.injector.get('debounceInput');\n\n    this.debouncedEditCell = debounceInput(this.editCell.bind(this));\n    this.editCell = this.editCell.bind(this);\n\n    this.onTypeChange = this.onTypeChange.bind(this);\n    this.onSetStartTimeNowClick = this.onSetStartTimeNowClick.bind(this);\n    this.onSetEndTimeNowClick = this.onSetEndTimeNowClick.bind(this);\n    this.onStartTimeInput = this.onStartTimeInput.bind(this);\n    this.onEndTimeInput = this.onEndTimeInput.bind(this);\n  }\n\n  editCell(cell, text) {\n    this._modeling.editCell(cell, text);\n  }\n\n  onTypeChange(value) {\n    const { element } = this.props.context;\n\n    const { times } = this.state;\n\n    this.setState({\n      type: value\n    });\n\n    if (parseString(getTimeString(value, times))) {\n      this.editCell(element.businessObject, getTimeString(value, times));\n    }\n  }\n\n  onSetStartTimeNowClick() {\n    const { element } = this.props.context;\n\n    const { times, type } = this.state;\n\n    const time = getSampleTime();\n\n    this.setState({\n      times: [ time, times[1] ]\n    });\n\n    if (parseString(getTimeString(type, [ time, times[1] ]))) {\n      this.editCell(element.businessObject, getTimeString(type, [ time, times[1] ]));\n    }\n  }\n\n  onSetEndTimeNowClick() {\n    const { element } = this.props.context;\n\n    const { times, type } = this.state;\n\n    const time = getSampleTime();\n\n    this.setState({\n      times: [ times[0], time ]\n    });\n\n    if (parseString(getTimeString(type, [ times[0], time ]))) {\n      this.editCell(element.businessObject, getTimeString(type, [ times[0], time ]));\n    }\n  }\n\n  onStartTimeInput({ value }) {\n    const { element } = this.props.context;\n\n    const { times, type } = this.state;\n\n    this.setState({\n      times: [ value, times[1] ]\n    });\n\n    this.debouncedEditCell(\n      element.businessObject,\n      getTimeString(type, [ value, times[1] ])\n    );\n  }\n\n  onEndTimeInput({ value }) {\n    const { element } = this.props.context;\n\n    const { times, type } = this.state;\n\n    this.setState({\n      times: [ times[0], value ]\n    });\n\n    this.debouncedEditCell(\n      element.businessObject,\n      getTimeString(type, [ times[0], value ])\n    );\n  }\n\n  render() {\n    const { times, type } = this.state;\n\n    const options = [{\n      label: 'Exactly',\n      value: EXACT\n    }, {\n      label: 'Before',\n      value: BEFORE\n    }, {\n      label: 'After',\n      value: AFTER\n    }, {\n      label: 'Between',\n      value: BETWEEN\n    }];\n\n    return (\n      <div class=\"context-menu-container simple-time-edit\">\n\n        <h3 class=\"dms-heading\">Edit time</h3>\n\n        <div className=\"dms-fill-row\">\n          <InputSelect\n            noInput={ true }\n            onChange={ this.onTypeChange }\n            options={ options }\n            value={ type } />\n        </div>\n\n        <h4 class=\"dms-heading\">\n          {\n            type === BETWEEN\n              ? 'Edit start time'\n              : 'Set time'\n          }\n        </h4>\n\n        <div>\n          <ValidatedInput\n            className=\"start-time-input dms-block\"\n            onInput={ this.onStartTimeInput }\n            placeholder={ `e.g. ${ getSampleTime() }` }\n            validate={ validateISOString }\n            value={ times[0] } />\n\n          <p className=\"dms-hint\">\n            <button type=\"button\"\n              className=\"use-now\"\n              onClick={ this.onSetStartTimeNowClick }>Use now</button>.\n          </p>\n        </div>\n\n        {\n          type === BETWEEN\n            && <h4 class=\"dms-heading\">\n              Edit end time\n            </h4>\n        }\n\n        {\n          type === BETWEEN\n            && <div>\n              <ValidatedInput\n                className=\"end-time-input dms-block\"\n                onInput={ this.onEndTimeInput }\n                placeholder={ `e.g. ${ getSampleTime() }` }\n                validate={ validateISOString }\n                value={ times[1] }>\n              </ValidatedInput>\n\n              <p className=\"dms-hint\">\n                <button type=\"button\"\n                  className=\"use-now\"\n                  onClick={ this.onSetEndTimeNowClick }>Use now</button>.\n              </p>\n            </div>\n        }\n\n      </div>\n    );\n  }\n}"],"file":"InputTimeEdit.js"}