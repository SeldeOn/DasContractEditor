{"version":3,"sources":["../../../src/features/view-drd/ViewDrd.js"],"names":["ViewDrdComponent","VERY_HIGH_PRIORITY","ViewDrd","components","viewer","eventBus","injector","_injector","_viewer","onGetComponent","canViewDrd","on","parent","get","definitions","getDefinitions","view","getView","open","getDecision","$inject","decision","$parent"],"mappings":";;;;;;AAAA,OAAOA,gBAAP,MAA6B,+BAA7B;AAEA,IAAMC,kBAAkB,GAAG,IAA3B;;IAGqBC,O;AAEnB,mBAAYC,UAAZ,EAAwBC,MAAxB,EAAgCC,QAAhC,EAA0CC,QAA1C,EAAoD;AAAA;;AAAA;;AAClD,SAAKC,SAAL,GAAiBD,QAAjB;AACA,SAAKE,OAAL,GAAeJ,MAAf;AAEAD,IAAAA,UAAU,CAACM,cAAX,CAA0B,QAA1B,EAAoCR,kBAApC,EAAwD,YAAM;AAC5D,UAAI,KAAI,CAACS,UAAL,EAAJ,EAAuB;AACrB,eAAOV,gBAAP;AACD;AACF,KAJD;AAMAK,IAAAA,QAAQ,CAACM,EAAT,CAAY,SAAZ,EAAuB,YAAM;AAC3B,UAAMC,MAAM,GAAGN,QAAQ,CAACO,GAAT,CAAa,SAAb,EAAwB,KAAxB,CAAf,CAD2B,CAG3B;;AACA,UAAMC,WAAW,GAAG,KAAI,CAACC,cAAL,EAApB,CAJ2B,CAM3B;;;AACA,UAAMC,IAAI,GAAGJ,MAAM,CAACK,OAAP,CAAeH,WAAf,CAAb;AAEAF,MAAAA,MAAM,CAACM,IAAP,CAAYF,IAAZ;AACD,KAVD;AAWD;;;;WAED,sBAAa;AACX,UAAMJ,MAAM,GAAG,KAAKL,SAAL,CAAeM,GAAf,CAAmB,SAAnB,EAA8B,KAA9B,CAAf;;AAEA,UAAI,CAACD,MAAL,EAAa;AACX;AACD,OALU,CAOX;;;AACA,UAAME,WAAW,GAAG,KAAKC,cAAL,EAApB;AAEA,aAAO,CAAC,CAACH,MAAM,CAACK,OAAP,CAAeH,WAAf,CAAT;AACD;;;WAED,0BAAiB;AACf,aAAOC,eAAc,CAAC,KAAKP,OAAL,CAAaW,WAAb,EAAD,CAArB;AACD;;;;;;SAxCkBjB,O;AA4CrBA,OAAO,CAACkB,OAAR,GAAkB,CAAE,YAAF,EAAgB,QAAhB,EAA0B,UAA1B,EAAsC,UAAtC,CAAlB,C,CAGA;;AAEA,SAASL,eAAT,CAAwBM,QAAxB,EAAkC;AAChC,MAAMP,WAAW,GAAGO,QAAQ,CAACC,OAA7B;AAEA,SAAOR,WAAP;AACD","sourcesContent":["import ViewDrdComponent from './components/ViewDrdComponent';\r\n\r\nconst VERY_HIGH_PRIORITY = 2000;\r\n\r\n\r\nexport default class ViewDrd {\r\n\r\n  constructor(components, viewer, eventBus, injector) {\r\n    this._injector = injector;\r\n    this._viewer = viewer;\r\n\r\n    components.onGetComponent('viewer', VERY_HIGH_PRIORITY, () => {\r\n      if (this.canViewDrd()) {\r\n        return ViewDrdComponent;\r\n      }\r\n    });\r\n\r\n    eventBus.on('showDrd', () => {\r\n      const parent = injector.get('_parent', false);\r\n\r\n      // there is only one single element\r\n      const definitions = this.getDefinitions();\r\n\r\n      // open definitions\r\n      const view = parent.getView(definitions);\r\n\r\n      parent.open(view);\r\n    });\r\n  }\r\n\r\n  canViewDrd() {\r\n    const parent = this._injector.get('_parent', false);\r\n\r\n    if (!parent) {\r\n      return;\r\n    }\r\n\r\n    // there is only one single element\r\n    const definitions = this.getDefinitions();\r\n\r\n    return !!parent.getView(definitions);\r\n  }\r\n\r\n  getDefinitions() {\r\n    return getDefinitions(this._viewer.getDecision());\r\n  }\r\n\r\n}\r\n\r\nViewDrd.$inject = [ 'components', 'viewer', 'eventBus', 'injector' ];\r\n\r\n\r\n// helpers //////////////////////\r\n\r\nfunction getDefinitions(decision) {\r\n  const definitions = decision.$parent;\r\n\r\n  return definitions;\r\n}"],"file":"ViewDrd.js"}