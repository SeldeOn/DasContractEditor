{"version":3,"sources":["../../src/components/EditableComponent.js"],"names":["Component","ContentEditable","EditableComponent","props","context","event","setState","focussed","onFocus","invalid","state","changing","onBlur","injector","debounceInput","get","inputChanged","value","onChange","currentValue","onInput","validate","className","placeholder","ctrlForNewline","getDisplayValue"],"mappings":"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","sourcesContent":["import { Component } from 'inferno';\n\nimport ContentEditable from './ContentEditable';\n\n\n/**\n * A base component for interactivity.\n *\n * @example\n *\n * class Foo extends EditableComponent {\n *\n *   render() {\n *     return (\n *       <div>{ this.getEditor() }</div>\n *     );\n *   }\n * }\n *\n * And in use:\n *\n * <Foo value={ blub }\n *      onChange={ (newValue) => { ... }\n *      onFocus={ () => { ... } }\n *      onBlur={ () => { ... } }\n *      validate={ (newValue) => { return 'some-error'; } }\n *      className=\"...\" } />\n *\n * Special classes added:\n *\n * * focused\n * * invalid\n *\n */\nexport default class EditableComponent extends Component {\n\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = {\n      changing: false,\n      focussed: false\n    };\n\n\n    const { injector } = context;\n\n    const debounceInput = injector.get('debounceInput');\n\n    this.inputChanged = debounceInput((value) => {\n      const { onChange } = this.props;\n\n      if (typeof onChange === 'function') {\n        onChange(value);\n      }\n\n      // only unset changed if user input and\n      // committed changed value equal. This prevents the\n      // input jumping back to the saved, good value.\n      const currentValue = this.state.changing;\n\n      this.setState({\n        changing: currentValue === value ? false : currentValue\n      });\n    });\n\n    this.onInput = (value) => {\n\n      var validate = this.props.validate || function() {};\n\n      var invalid = validate(value);\n\n      this.setState({\n        changing: value,\n        invalid: invalid\n      });\n\n      if (!invalid) {\n        this.inputChanged(value);\n      }\n    };\n  }\n\n  onFocus = event => {\n    this.setState({\n      focussed: true\n    });\n\n    var { onFocus } = this.props;\n\n    if (typeof onFocus === 'function') {\n      onFocus(event);\n    }\n  }\n\n  onBlur = event => {\n    this.setState({\n      focussed: false\n    });\n\n    const { invalid } = this.state;\n\n    if (invalid) {\n      this.setState({\n        changing: false,\n        invalid: false\n      });\n    }\n\n    const { onBlur } = this.props;\n\n    if (typeof onBlur === 'function') {\n      onBlur(event);\n    }\n  }\n\n  getClassName() {\n    var {\n      className,\n      value\n    } = this.props;\n\n    var {\n      changing,\n      focussed,\n      invalid\n    } = this.state;\n\n    className += ' editable';\n\n    if (focussed) {\n      className += ' focussed';\n    }\n\n    if (invalid) {\n      className += ' invalid';\n    }\n\n    if (!value && !changing) {\n      className += ' empty';\n    }\n\n    return className;\n  }\n\n  getDisplayValue() {\n\n    var {\n      value,\n      placeholder\n    } = this.props;\n\n    var {\n      focussed,\n      changing\n    } = this.state;\n\n    if (typeof changing === 'string') {\n      value = changing;\n    }\n\n    if (!value) {\n      value = focussed ? '' : (placeholder || '');\n    }\n\n    return value;\n  }\n\n  getEditor(props = {}) {\n\n    return (\n      <ContentEditable\n        className={ props.className }\n        ctrlForNewline={ props.ctrlForNewline }\n        onFocus={ this.onFocus }\n        onBlur={ this.onBlur }\n        onInput={ this.onInput }\n        value={ this.getDisplayValue() } />\n    );\n  }\n\n}\n"],"file":"EditableComponent.js"}