{"version":3,"sources":["../../src/import/Importer.js"],"names":["DrdTreeWalker","importDRD","drd","definitions","done","importer","get","eventBus","error","warnings","render","visitor","root","element","di","add","message","context","push","walker","handleDefinitions","fire","e"],"mappings":"AAAA,OAAOA,aAAP,MAA0B,iBAA1B;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,SAASC,SAAT,CAAmBC,GAAnB,EAAwBC,WAAxB,EAAqCC,IAArC,EAA2C;AAEhD,MAAIC,QAAQ,GAAGH,GAAG,CAACI,GAAJ,CAAQ,aAAR,CAAf;AAAA,MACIC,QAAQ,GAAGL,GAAG,CAACI,GAAJ,CAAQ,UAAR,CADf;AAGA,MAAIE,KAAJ;AAAA,MACIC,QAAQ,GAAG,EADf;;AAGA,WAASC,MAAT,CAAgBP,WAAhB,EAA6B;AAE3B,QAAIQ,OAAO,GAAG;AACZC,MAAAA,IAAI,EAAE,cAASC,OAAT,EAAkB;AACtB,eAAOR,QAAQ,CAACO,IAAT,CAAcC,OAAd,CAAP;AACD,OAHW;AAKZA,MAAAA,OAAO,EAAE,iBAASA,QAAT,EAAkBC,EAAlB,EAAsB;AAC7B,eAAOT,QAAQ,CAACU,GAAT,CAAaF,QAAb,EAAsBC,EAAtB,CAAP;AACD,OAPW;AASZN,MAAAA,KAAK,EAAE,eAASQ,OAAT,EAAkBC,OAAlB,EAA2B;AAChCR,QAAAA,QAAQ,CAACS,IAAT,CAAc;AAAEF,UAAAA,OAAO,EAAEA,OAAX;AAAoBC,UAAAA,OAAO,EAAEA;AAA7B,SAAd;AACD;AAXW,KAAd;AAcA,QAAIE,MAAM,GAAG,IAAInB,aAAJ,CAAkBW,OAAlB,CAAb,CAhB2B,CAkB3B;;AACAQ,IAAAA,MAAM,CAACC,iBAAP,CAAyBjB,WAAzB;AACD;;AAEDI,EAAAA,QAAQ,CAACc,IAAT,CAAc,cAAd,EAA8B;AAAElB,IAAAA,WAAW,EAAEA;AAAf,GAA9B;;AAEA,MAAI;AACFO,IAAAA,MAAM,CAACP,WAAD,CAAN;AACD,GAFD,CAEE,OAAOmB,CAAP,EAAU;AACVd,IAAAA,KAAK,GAAGc,CAAR;AACD;;AAEDf,EAAAA,QAAQ,CAACc,IAAT,CAAc,aAAd,EAA6B;AAAEb,IAAAA,KAAK,EAAEA,KAAT;AAAgBC,IAAAA,QAAQ,EAAEA;AAA1B,GAA7B;AAEAL,EAAAA,IAAI,CAACI,KAAD,EAAQC,QAAR,CAAJ;AACD","sourcesContent":["import DrdTreeWalker from './DrdTreeWalker';\n\n\n/**\n * Import the definitions into a diagram.\n *\n * Errors and warnings are reported through the specified callback.\n *\n * @param  {Drd} drd\n * @param  {ModdleElement} definitions\n * @param  {Function} done\n *         the callback, invoked with (err, [ warning ]) once the import is done\n */\nexport function importDRD(drd, definitions, done) {\n\n  var importer = drd.get('drdImporter'),\n      eventBus = drd.get('eventBus');\n\n  var error,\n      warnings = [];\n\n  function render(definitions) {\n\n    var visitor = {\n      root: function(element) {\n        return importer.root(element);\n      },\n\n      element: function(element, di) {\n        return importer.add(element, di);\n      },\n\n      error: function(message, context) {\n        warnings.push({ message: message, context: context });\n      }\n    };\n\n    var walker = new DrdTreeWalker(visitor);\n\n    // import\n    walker.handleDefinitions(definitions);\n  }\n\n  eventBus.fire('import.start', { definitions: definitions });\n\n  try {\n    render(definitions);\n  } catch (e) {\n    error = e;\n  }\n\n  eventBus.fire('import.done', { error: error, warnings: warnings });\n\n  done(error, warnings);\n}"],"file":"Importer.js"}