{"version":3,"sources":["../../src/draw/DrdRenderer.js"],"names":["inherits","isArray","isObject","assign","attr","domAttr","query","domQuery","append","svgAppend","svgAttr","create","svgCreate","BaseRenderer","createLine","is","getName","DrdRenderer","eventBus","pathMap","styles","textRenderer","call","markers","addMarker","id","element","marker","initMarkers","svg","createMarker","options","attrs","strokeWidth","strokeLinecap","strokeDasharray","ref","x","y","scale","viewBox","refX","refY","markerWidth","markerHeight","orient","defs","associationStart","d","fill","stroke","associationEnd","informationRequirementEnd","knowledgeRequirementEnd","authorityRequirementEnd","cx","cy","r","computeStyle","custom","traits","defaultStyles","style","drawRect","p","width","height","offset","rect","rx","ry","renderLabel","label","text","createText","renderEmbeddedLabel","align","name","box","padding","drawPath","path","handlers","pathData","getScaledPath","xScaleFactor","yScaleFactor","containerWidth","containerHeight","position","mx","my","knowledgeSource","businessKnowledge","textElement","textPathData","getSemantic","semantic","strokeLinejoin","associationDirection","markerEnd","markerStart","drawLine","waypoints","drawShape","parent","h","type","prototype","apply","drawConnection","line","canRender","on","event","$inject","businessObject"],"mappings":"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","sourcesContent":["import inherits from 'inherits';\n\nimport {\n  isArray,\n  isObject,\n  assign\n} from 'min-dash';\n\nimport {\n  attr as domAttr,\n  query as domQuery\n} from 'min-dom';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport BaseRenderer from 'diagram-js/lib/draw/BaseRenderer';\n\nimport {\n  createLine\n} from 'diagram-js/lib/util/RenderUtil';\n\nimport {\n  is,\n  getName\n} from 'dmn-js-shared/lib/util/ModelUtil';\n\n\nexport default function DrdRenderer(eventBus, pathMap, styles, textRenderer) {\n\n  BaseRenderer.call(this, eventBus);\n\n  var markers = {};\n\n  function addMarker(id, element) {\n    markers[id] = element;\n  }\n\n  function marker(id) {\n    var marker = markers[id];\n\n    return 'url(#' + marker.id + ')';\n  }\n\n  function initMarkers(svg) {\n\n    function createMarker(id, options) {\n      var attrs = assign({\n        strokeWidth: 1,\n        strokeLinecap: 'round',\n        strokeDasharray: 'none'\n      }, options.attrs);\n\n      var ref = options.ref || { x: 0, y: 0 };\n\n      var scale = options.scale || 1;\n\n      // fix for safari / chrome / firefox bug not correctly\n      // resetting stroke dash array\n      if (attrs.strokeDasharray === 'none') {\n        attrs.strokeDasharray = [10000, 1];\n      }\n\n      var marker = svgCreate('marker');\n\n      svgAttr(options.element, attrs);\n\n      svgAppend(marker, options.element);\n\n      svgAttr(marker, {\n        id: id,\n        viewBox: '0 0 20 20',\n        refX: ref.x,\n        refY: ref.y,\n        markerWidth: 20 * scale,\n        markerHeight: 20 * scale,\n        orient: 'auto'\n      });\n\n      var defs = domQuery('defs', svg);\n\n      if (!defs) {\n        defs = svgCreate('defs');\n\n        svgAppend(svg, defs);\n      }\n\n      svgAppend(defs, marker);\n\n      return addMarker(id, marker);\n    }\n\n    var associationStart = svgCreate('path');\n    svgAttr(associationStart, { d: 'M 11 5 L 1 10 L 11 15' });\n\n    createMarker('association-start', {\n      element: associationStart,\n      attrs: {\n        fill: 'none',\n        stroke: 'black',\n        strokeWidth: 1.5\n      },\n      ref: { x: 1, y: 10 },\n      scale: 0.5\n    });\n\n    var associationEnd = svgCreate('path');\n    svgAttr(associationEnd, { d: 'M 1 5 L 11 10 L 1 15' });\n\n    createMarker('association-end', {\n      element: associationEnd,\n      attrs: {\n        fill: 'none',\n        stroke: 'black',\n        strokeWidth: 1.5\n      },\n      ref: { x: 12, y: 10 },\n      scale: 0.5\n    });\n\n    var informationRequirementEnd = svgCreate('path');\n    svgAttr(informationRequirementEnd, { d: 'M 1 5 L 11 10 L 1 15 Z' });\n\n    createMarker('information-requirement-end', {\n      element: informationRequirementEnd,\n      ref: { x: 11, y: 10 },\n      scale: 1\n    });\n\n    var knowledgeRequirementEnd = svgCreate('path');\n    svgAttr(knowledgeRequirementEnd, { d: 'M 1 3 L 11 10 L 1 17' });\n\n    createMarker('knowledge-requirement-end', {\n      element: knowledgeRequirementEnd,\n      attrs: {\n        fill: 'none',\n        stroke: 'black',\n        strokeWidth: 2\n      },\n      ref: { x: 11, y: 10 },\n      scale: 0.8\n    });\n\n    var authorityRequirementEnd = svgCreate('circle');\n    svgAttr(authorityRequirementEnd, { cx: 3, cy: 3, r: 3 });\n\n    createMarker('authority-requirement-end', {\n      element: authorityRequirementEnd,\n      ref: { x: 3, y: 3 },\n      scale: 0.9\n    });\n  }\n\n  function computeStyle(custom, traits, defaultStyles) {\n    if (!isArray(traits)) {\n      defaultStyles = traits;\n      traits = [];\n    }\n\n    return styles.style(traits || [], assign(defaultStyles, custom || {}));\n  }\n\n\n  function drawRect(p, width, height, r, offset, attrs) {\n\n    if (isObject(offset)) {\n      attrs = offset;\n      offset = 0;\n    }\n\n    offset = offset || 0;\n\n    attrs = computeStyle(attrs, {\n      stroke: 'black',\n      strokeWidth: 2,\n      fill: 'white'\n    });\n\n    var rect = svgCreate('rect');\n    svgAttr(rect, {\n      x: offset,\n      y: offset,\n      width: width - offset * 2,\n      height: height - offset * 2,\n      rx: r,\n      ry: r\n    });\n    svgAttr(rect, attrs);\n\n    svgAppend(p, rect);\n\n    return rect;\n  }\n\n  function renderLabel(p, label, options) {\n    var text = textRenderer.createText(label || '', options);\n\n    domAttr(text, 'class', 'djs-label');\n\n    svgAppend(p, text);\n\n    return text;\n  }\n\n  function renderEmbeddedLabel(p, element, align) {\n    var name = getName(element);\n    return renderLabel(p, name, { box: element, align: align, padding: 5 });\n  }\n\n  function drawPath(p, d, attrs) {\n\n    attrs = computeStyle(attrs, [ 'no-fill' ], {\n      strokeWidth: 2,\n      stroke: 'black'\n    });\n\n    var path = svgCreate('path');\n    svgAttr(path, { d: d });\n    svgAttr(path, attrs);\n\n    svgAppend(p, path);\n\n    return path;\n  }\n\n\n  var handlers = {\n    'dmn:Decision': function(p, element, attrs) {\n      var rect = drawRect(p, element.width, element.height, 0, attrs);\n\n      renderEmbeddedLabel(p, element, 'center-middle');\n\n      return rect;\n    },\n    'dmn:KnowledgeSource': function(p, element, attrs) {\n\n      var pathData = pathMap.getScaledPath('KNOWLEDGE_SOURCE', {\n        xScaleFactor: 1.021,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.0,\n          my: 0.075\n        }\n      });\n\n      var knowledgeSource = drawPath(p, pathData, {\n        strokeWidth: 2,\n        fill: 'white',\n        stroke: 'black'\n      });\n\n      renderEmbeddedLabel(p, element, 'center-middle');\n\n      return knowledgeSource;\n    },\n    'dmn:BusinessKnowledgeModel': function(p, element, attrs) {\n\n      var pathData = pathMap.getScaledPath('BUSINESS_KNOWLEDGE_MODEL', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.0,\n          my: 0.3\n        }\n      });\n\n      var businessKnowledge = drawPath(p, pathData, {\n        strokeWidth: 2,\n        fill: 'white',\n        stroke: 'black'\n      });\n\n      renderEmbeddedLabel(p, element, 'center-middle');\n\n      return businessKnowledge;\n    },\n    'dmn:InputData': function(p, element, attrs) {\n\n      var rect = drawRect(p, element.width, element.height, 22, attrs);\n\n      renderEmbeddedLabel(p, element, 'center-middle');\n\n      return rect;\n    },\n    'dmn:TextAnnotation': function(p, element, attrs) {\n      var style = {\n        'fill': 'none',\n        'stroke': 'none'\n      };\n\n      var textElement = drawRect(p, element.width, element.height, 0, 0, style);\n\n      var textPathData = pathMap.getScaledPath('TEXT_ANNOTATION', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.0,\n          my: 0.0\n        }\n      });\n\n      drawPath(p, textPathData);\n\n      var text = getSemantic(element).text || '';\n\n      renderLabel(p, text, {\n        box: element,\n        align: 'left-top',\n        padding: 5\n      });\n\n      return textElement;\n    },\n    'dmn:Association': function(p, element, attrs) {\n      var semantic = getSemantic(element);\n\n      attrs = assign({\n        strokeDasharray: '0.5, 5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        fill: 'none'\n      }, attrs || {});\n\n      if (semantic.associationDirection === 'One' ||\n          semantic.associationDirection === 'Both') {\n        attrs.markerEnd = marker('association-end');\n      }\n\n      if (semantic.associationDirection === 'Both') {\n        attrs.markerStart = marker('association-start');\n      }\n\n      return drawLine(p, element.waypoints, attrs);\n    },\n    'dmn:InformationRequirement': function(p, element, attrs) {\n\n      attrs = assign({\n        strokeWidth: 1,\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        markerEnd: marker('information-requirement-end')\n      }, attrs || {});\n\n      return drawLine(p, element.waypoints, attrs);\n    },\n    'dmn:KnowledgeRequirement': function(p, element, attrs) {\n\n      attrs = assign({\n        strokeWidth: 1,\n        strokeDasharray: 5,\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        markerEnd: marker('knowledge-requirement-end')\n      }, attrs || {});\n\n      return drawLine(p, element.waypoints, attrs);\n    },\n    'dmn:AuthorityRequirement': function(p, element, attrs) {\n\n      attrs = assign({\n        strokeWidth: 1.5,\n        strokeDasharray: 5,\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        markerEnd: marker('authority-requirement-end')\n      }, attrs || {});\n\n      return drawLine(p, element.waypoints, attrs);\n    }\n  };\n\n\n  // draw shape and connection //////////////////\n\n  function drawShape(parent, element) {\n    var h = handlers[element.type];\n\n    if (!h) {\n      return BaseRenderer.prototype.drawShape.apply(this, [ parent, element ]);\n    } else {\n      return h(parent, element);\n    }\n  }\n\n  function drawConnection(parent, element) {\n    var type = element.type;\n    var h = handlers[type];\n\n    if (!h) {\n      return BaseRenderer.prototype.drawConnection.apply(this, [ parent, element ]);\n    } else {\n      return h(parent, element);\n    }\n  }\n\n  function drawLine(p, waypoints, attrs) {\n    attrs = computeStyle(attrs, [ 'no-fill' ], {\n      stroke: 'black',\n      strokeWidth: 2,\n      fill: 'none'\n    });\n\n    var line = createLine(waypoints, attrs);\n\n    svgAppend(p, line);\n\n    return line;\n  }\n\n  this.canRender = function(element) {\n    return is(element, 'dmn:DMNElement') ||\n           is(element, 'dmn:InformationRequirement') ||\n           is(element, 'dmn:KnowledgeRequirement') ||\n           is(element, 'dmn:AuthorityRequirement');\n  };\n\n  this.drawShape = drawShape;\n  this.drawConnection = drawConnection;\n\n\n  // hook onto canvas init event to initialize\n  // connection start/end markers on svg\n  eventBus.on('canvas.init', function(event) {\n    initMarkers(event.svg);\n  });\n\n}\n\ninherits(DrdRenderer, BaseRenderer);\n\nDrdRenderer.$inject = [\n  'eventBus',\n  'pathMap',\n  'styles',\n  'textRenderer'\n];\n\n\n// helper functions //////////////////////\n\nfunction getSemantic(element) {\n  return element.businessObject;\n}\n"],"file":"DrdRenderer.js"}