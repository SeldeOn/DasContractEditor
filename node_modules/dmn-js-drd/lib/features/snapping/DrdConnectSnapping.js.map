{"version":3,"sources":["../../../src/features/snapping/DrdConnectSnapping.js"],"names":["asTRBL","getMid","getOrientation","LOW_PRIORITY","DrdConnectSnapping","eventBus","on","event","context","canExecute","hover","source","target","type","orientation","connectionStart","connectionEnd","x","y","includes","top","bottom","left","right","$inject"],"mappings":"AAAA,SACEA,MADF,EAEEC,MAFF,EAGEC,cAHF,QAIO,kCAJP;AAMA,IAAIC,YAAY,GAAG,GAAnB;AAGA,eAAe,SAASC,kBAAT,CAA4BC,QAA5B,EAAsC;AACnDA,EAAAA,QAAQ,CAACC,EAAT,CAAY,CACV,eADU,EAEV,cAFU,EAGV,aAHU,CAAZ,EAIGH,YAJH,EAIiB,UAASI,KAAT,EAAgB;AAC/B,QAAIC,OAAO,GAAGD,KAAK,CAACC,OAApB;AAAA,QACIC,UAAU,GAAGD,OAAO,CAACC,UADzB;AAAA,QAEIC,KAAK,GAAGF,OAAO,CAACE,KAFpB;AAAA,QAGIC,MAAM,GAAGH,OAAO,CAACG,MAHrB;AAAA,QAIIC,MAAM,GAAGJ,OAAO,CAACI,MAJrB;;AAMA,QAAIH,UAAU,IAAIA,UAAU,CAACI,IAAX,KAAoB,4BAAtC,EAAoE;AAClE,UAAIC,WAAW,GAAGZ,cAAc,CAACS,MAAD,EAASC,MAAT,CAAhC,CADkE,CAGlE;;AACAJ,MAAAA,OAAO,CAACO,eAAR,GAA0Bd,MAAM,CAACU,MAAD,CAAhC,CAJkE,CAMlE;;AACA,UAAID,KAAK,KAAKC,MAAd,EAAsB;AACpBH,QAAAA,OAAO,CAACQ,aAAR,GAAwBf,MAAM,CAACW,MAAD,CAA9B;AACD,OAFD,MAEO;AACLJ,QAAAA,OAAO,CAACQ,aAAR,GAAwB;AACtBC,UAAAA,CAAC,EAAEV,KAAK,CAACU,CADa;AAEtBC,UAAAA,CAAC,EAAEX,KAAK,CAACW;AAFa,SAAxB;AAID;;AAED,UAAIJ,WAAW,CAACK,QAAZ,CAAqB,QAArB,CAAJ,EAAoC;AAClCX,QAAAA,OAAO,CAACO,eAAR,CAAwBG,CAAxB,GAA4BlB,MAAM,CAACW,MAAD,CAAN,CAAeS,GAA3C;AACAZ,QAAAA,OAAO,CAACQ,aAAR,CAAsBE,CAAtB,GAA0BlB,MAAM,CAACY,MAAD,CAAN,CAAeS,MAAzC;AACD,OAHD,MAGO,IAAIP,WAAW,CAACK,QAAZ,CAAqB,KAArB,CAAJ,EAAiC;AACtCX,QAAAA,OAAO,CAACO,eAAR,CAAwBG,CAAxB,GAA4BlB,MAAM,CAACW,MAAD,CAAN,CAAeU,MAA3C;AACAb,QAAAA,OAAO,CAACQ,aAAR,CAAsBE,CAAtB,GAA0BlB,MAAM,CAACY,MAAD,CAAN,CAAeQ,GAAzC;AACD,OAHM,MAGA,IAAIN,WAAW,CAACK,QAAZ,CAAqB,OAArB,CAAJ,EAAmC;AACxCX,QAAAA,OAAO,CAACO,eAAR,CAAwBE,CAAxB,GAA4BjB,MAAM,CAACW,MAAD,CAAN,CAAeW,IAA3C;AACAd,QAAAA,OAAO,CAACQ,aAAR,CAAsBC,CAAtB,GAA0BjB,MAAM,CAACY,MAAD,CAAN,CAAeW,KAAzC;AACD,OAHM,MAGA;AACLf,QAAAA,OAAO,CAACO,eAAR,CAAwBE,CAAxB,GAA4BjB,MAAM,CAACW,MAAD,CAAN,CAAeY,KAA3C;AACAf,QAAAA,OAAO,CAACQ,aAAR,CAAsBC,CAAtB,GAA0BjB,MAAM,CAACY,MAAD,CAAN,CAAeU,IAAzC;AACD;AACF,KA7BD,MA6BO;AACL,aAAOd,OAAO,CAACO,eAAf;AACA,aAAOP,OAAO,CAACQ,aAAf;AACD;AACF,GA5CD;AA6CD;AAEDZ,kBAAkB,CAACoB,OAAnB,GAA6B,CAAE,UAAF,CAA7B","sourcesContent":["import {\r\n  asTRBL,\r\n  getMid,\r\n  getOrientation\r\n} from 'diagram-js/lib/layout/LayoutUtil';\r\n\r\nvar LOW_PRIORITY = 250;\r\n\r\n\r\nexport default function DrdConnectSnapping(eventBus) {\r\n  eventBus.on([\r\n    'connect.hover',\r\n    'connect.move',\r\n    'connect.end',\r\n  ], LOW_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        canExecute = context.canExecute,\r\n        hover = context.hover,\r\n        source = context.source,\r\n        target = context.target;\r\n\r\n    if (canExecute && canExecute.type === 'dmn:InformationRequirement') {\r\n      var orientation = getOrientation(source, target);\r\n\r\n      // snap source\r\n      context.connectionStart = getMid(source);\r\n\r\n      // snap target\r\n      if (hover === source) {\r\n        context.connectionEnd = getMid(target);\r\n      } else {\r\n        context.connectionEnd = {\r\n          x: event.x,\r\n          y: event.y\r\n        };\r\n      }\r\n\r\n      if (orientation.includes('bottom')) {\r\n        context.connectionStart.y = asTRBL(source).top;\r\n        context.connectionEnd.y = asTRBL(target).bottom;\r\n      } else if (orientation.includes('top')) {\r\n        context.connectionStart.y = asTRBL(source).bottom;\r\n        context.connectionEnd.y = asTRBL(target).top;\r\n      } else if (orientation.includes('right')) {\r\n        context.connectionStart.x = asTRBL(source).left;\r\n        context.connectionEnd.x = asTRBL(target).right;\r\n      } else {\r\n        context.connectionStart.x = asTRBL(source).right;\r\n        context.connectionEnd.x = asTRBL(target).left;\r\n      }\r\n    } else {\r\n      delete context.connectionStart;\r\n      delete context.connectionEnd;\r\n    }\r\n  });\r\n}\r\n\r\nDrdConnectSnapping.$inject = [ 'eventBus' ];"],"file":"DrdConnectSnapping.js"}