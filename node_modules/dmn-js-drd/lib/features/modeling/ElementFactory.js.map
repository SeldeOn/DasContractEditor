{"version":3,"sources":["../../../src/features/modeling/ElementFactory.js"],"names":["assign","inherits","is","BaseElementFactory","BUSINESS_KNOWLEDGE_MODEL_SIZE","width","height","DECISION_SIZE","INPUT_DATA_SIZE","KNOWLEDGE_SOURCE_SIZE","ElementFactory","drdFactory","call","_drdFactory","$inject","prototype","baseCreate","create","elementType","attrs","createDrdElement","size","businessObject","type","Error","di","createDiEdge","createDiShape","_getDefaultSize","id","semantic"],"mappings":"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","sourcesContent":["import {\n  assign\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport {\n  is\n} from 'dmn-js-shared/lib/util/ModelUtil';\n\nimport BaseElementFactory from 'diagram-js/lib/core/ElementFactory';\n\nexport var BUSINESS_KNOWLEDGE_MODEL_SIZE = { width: 135, height: 46 };\nexport var DECISION_SIZE = { width: 180, height: 80 };\nexport var INPUT_DATA_SIZE = { width: 125, height: 45 };\nexport var KNOWLEDGE_SOURCE_SIZE = { width: 100, height: 63 };\n\n\n/**\n * A drd-aware factory for diagram-js shapes\n */\nexport default function ElementFactory(drdFactory) {\n  BaseElementFactory.call(this);\n\n  this._drdFactory = drdFactory;\n}\n\ninherits(ElementFactory, BaseElementFactory);\n\n\nElementFactory.$inject = [ 'drdFactory' ];\n\nElementFactory.prototype.baseCreate = BaseElementFactory.prototype.create;\n\nElementFactory.prototype.create = function(elementType, attrs) {\n  return this.createDrdElement(elementType, attrs);\n};\n\nElementFactory.prototype.createDrdElement = function(elementType, attrs) {\n  var drdFactory = this._drdFactory;\n\n  var size;\n\n  attrs = attrs || {};\n\n  var businessObject = attrs.businessObject;\n\n  if (!businessObject) {\n    if (!attrs.type) {\n      throw new Error('no shape type specified');\n    }\n\n    businessObject = drdFactory.create(attrs.type);\n  }\n\n  if (!businessObject.di) {\n    if (elementType === 'connection') {\n      businessObject.di = drdFactory.createDiEdge(businessObject, []);\n    } else if (elementType === 'shape') {\n      businessObject.di = drdFactory.createDiShape(businessObject, {});\n    }\n  }\n\n  size = this._getDefaultSize(businessObject);\n\n  attrs = assign({\n    businessObject: businessObject,\n    id: businessObject.id\n  }, size, attrs);\n\n  return this.baseCreate(elementType, attrs);\n};\n\n\nElementFactory.prototype._getDefaultSize = function(semantic) {\n  if (is(semantic, 'dmn:BusinessKnowledgeModel')) {\n    return BUSINESS_KNOWLEDGE_MODEL_SIZE;\n  }\n\n  if (is(semantic, 'dmn:Decision')) {\n    return DECISION_SIZE;\n  }\n\n  if (is(semantic, 'dmn:InputData')) {\n    return INPUT_DATA_SIZE;\n  }\n\n  if (is(semantic, 'dmn:KnowledgeSource')) {\n    return KNOWLEDGE_SOURCE_SIZE;\n  }\n\n  return { width: 100, height: 80 };\n};\n"],"file":"ElementFactory.js"}